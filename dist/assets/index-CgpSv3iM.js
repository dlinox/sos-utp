import{_ as I,a as j,b as q}from"./office.services-CqMnrejG.js";import{d as C,e as p,r as o,o as f,c as b,w as t,a as e,u as y,g as U,f as G,h as B,i as g,t as H}from"./index-CqlVs-0d.js";import{r as F}from"./ruleUtils-DaB-ACZt.js";import{_ as L}from"./DialogConfirm.vue_vue_type_script_setup_true_lang-C_UyCIvg.js";const P={name:[F],description:[]},M=()=>({id:null,name:"",description:null,status:!0}),$=C({__name:"Form",props:{formState:{type:Object,default:()=>({})}},emits:["onSuccess"],setup(k,{emit:m}){const r=m,i=k,a=p(!1),d=p(!1),l=p({...M(),...i.formState}),w=async()=>{a.value=!0,await I(l.value)&&(r("onSuccess"),d.value=!1),a.value=!1};return(v,n)=>{const x=o("v-text-field"),u=o("v-col"),s=o("v-textarea"),V=o("v-switch"),T=o("v-row"),D=o("v-card-item"),_=o("v-btn"),O=o("v-spacer"),S=o("v-card-actions"),E=o("v-card"),N=o("v-form"),R=o("v-dialog");return f(),b(R,{"max-width":"700",modelValue:d.value,"onUpdate:modelValue":n[4]||(n[4]=c=>d.value=c),activator:"parent"},{default:t(()=>[e(N,{ref:"formRef",onSubmit:G(w,["prevent"])},{default:t(()=>[e(E,{title:l.value.id?"Editar Registro":"Nuevo Registro"},{default:t(()=>[e(D,{class:"border-t border-b"},{default:t(()=>[e(T,null,{default:t(()=>[e(u,{cols:"12"},{default:t(()=>[e(x,{modelValue:l.value.name,"onUpdate:modelValue":n[0]||(n[0]=c=>l.value.name=c),label:"Nombre",rules:y(P).name},null,8,["modelValue","rules"])]),_:1}),e(u,{cols:"12"},{default:t(()=>[e(s,{modelValue:l.value.description,"onUpdate:modelValue":n[1]||(n[1]=c=>l.value.description=c),label:"Descripción",rules:y(P).description,rows:"2"},null,8,["modelValue","rules"])]),_:1}),e(u,{cols:"12"},{default:t(()=>[e(V,{label:l.value.status?"Habilitado":"Deshabilitado",modelValue:l.value.status,"onUpdate:modelValue":n[2]||(n[2]=c=>l.value.status=c),color:"blue-darken-4",inset:""},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1}),e(S,null,{default:t(()=>[e(_,{type:"button",variant:"text",color:"secondary",onClick:n[3]||(n[3]=c=>d.value=!1)},{default:t(()=>n[5]||(n[5]=[U(" Cancelar ")])),_:1}),e(O),e(_,{text:"Guardar",color:"primary",type:"submit",loading:a.value},null,8,["loading"])]),_:1})]),_:1},8,["title"])]),_:1},512)]),_:1},8,["modelValue"])}}}),z=[{title:"Op.",key:"actions",value:"actions",fixed:!0,width:"50px",sortable:!1},{title:"Nombre",key:"name",value:"name"},{title:"Descripción",key:"description",value:"description"},{title:"Estado",key:"status",value:"status"}],A=C({__name:"DataTable",props:{options:{},items:{},loading:{type:Boolean},total:{}},emits:["onUpdateTable"],setup(k,{emit:m}){const r=m;return(i,a)=>{const d=o("v-icon"),l=o("v-list-item"),w=o("v-list"),v=o("v-menu"),n=o("v-btn"),x=o("v-data-table-server"),u=B("permission");return f(),b(x,{"items-per-page":i.options.itemsPerPage,"onUpdate:itemsPerPage":[a[1]||(a[1]=s=>i.options.itemsPerPage=s),a[4]||(a[4]=s=>r("onUpdateTable"))],"sort-by":i.options.sortBy,"onUpdate:sortBy":[a[2]||(a[2]=s=>i.options.sortBy=s),a[5]||(a[5]=s=>r("onUpdateTable"))],page:i.options.page,"onUpdate:page":[a[3]||(a[3]=s=>i.options.page=s),a[6]||(a[6]=s=>r("onUpdateTable"))],headers:y(z),items:i.items,"items-length":i.total,loading:i.loading,"item-value":"id","multi-sort":""},{"item.actions":t(({item:s})=>[g((f(),b(n,{icon:"",density:"compact",variant:"text"},{default:t(()=>[e(d,null,{default:t(()=>a[7]||(a[7]=[U("mdi-dots-vertical")])),_:1}),e(v,{activator:"parent"},{default:t(()=>[e(w,{density:"compact"},{default:t(()=>[g((f(),b(l,{key:"edit",value:"edit",title:"Editar","append-icon":"mdi-pencil"},{default:t(()=>[e(y($),{formState:s,onOnSuccess:a[0]||(a[0]=V=>r("onUpdateTable"))},null,8,["formState"])]),_:2},1024)),[[u,["offices.edit"]]]),g((f(),b(l,{key:"delete",value:"delete",title:"Eliminar",class:"text-red","append-icon":"mdi-delete"},{default:t(()=>[e(L,{title:"Eliminar",message:"¿Está seguro de eliminar este registro?",onOnConfirm:async()=>{await y(j)(s.id)&&r("onUpdateTable")}},null,8,["onOnConfirm"])]),_:2},1024)),[[u,["offices.delete"]]])]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[u,["offices.edit","offices.delete"]]])]),"item.status":t(({item:s})=>[e(n,{color:s.status?"blue":"error","text-color":"white",density:"compact",variant:"tonal"},{default:t(()=>[U(H(s.status?"Habilitado":"Deshabilitado"),1)]),_:2},1032,["color"])]),_:1},8,["items-per-page","sort-by","page","headers","items","items-length","loading"])}}}),X=C({__name:"index",setup(k){const m=p(!1),r=p(!1),i=p([]),a=p(0),d=p({itemsPerPage:10,sortBy:[],page:1,search:"",filters:{}}),l=async()=>{r.value=!0;const v=await q(d.value);i.value=v.data,a.value=v.total,r.value=!1},w=async()=>{m.value=!0,await l(),m.value=!1};return w(),(v,n)=>{const x=o("v-text-field"),u=o("v-col"),s=o("v-btn"),V=o("v-row"),T=o("v-card-item"),D=o("v-card"),_=B("permission"),O=B("tooltip");return f(),b(D,{title:"Oficinas",subtitle:"Gestión de oficinas",disabled:m.value},{default:t(()=>[e(T,{class:"border-t border-b"},{default:t(()=>[e(V,{class:"d-flex justify-space-between"},{default:t(()=>[e(u,{cols:"12",md:"4"},{default:t(()=>[g(e(x,{modelValue:d.value.search,"onUpdate:modelValue":n[0]||(n[0]=S=>d.value.search=S),label:"Buscar",clearable:"",onInput:l},null,8,["modelValue"]),[[_,["offices.index"]]])]),_:1}),e(u,{cols:"12",md:"4",class:"d-md-flex d-block justify-end text-end"},{default:t(()=>[g((f(),b(s,{class:"h-md-auto me-2",disabled:m.value},{default:t(()=>[n[1]||(n[1]=U(" nuevo ")),e(y($),{onOnSuccess:l})]),_:1},8,["disabled"])),[[_,["offices.create"]]]),g(e(s,{class:"h-md-auto",density:"comfortable",icon:"mdi-reload",onClick:w,loading:r.value},null,8,["loading"]),[[O,"Recargar registros"],[_,["offices.index"]]])]),_:1})]),_:1})]),_:1}),g(e(y(A),{options:d.value,loading:r.value,items:i.value,total:a.value,onOnUpdateTable:l},null,8,["options","loading","items","total"]),[[_,["offices.index"]]])]),_:1},8,["disabled"])}}});export{X as default};
