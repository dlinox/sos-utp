import{_ as j,a as q,b as z}from"./position.services-LdXWdsXF.js";import{d as $,e as d,r as a,o as y,c as x,w as o,a as e,u as w,g as b,f as G,h as B,i as k,t as H}from"./index-CqlVs-0d.js";import{r as F}from"./ruleUtils-DaB-ACZt.js";import{_ as L}from"./DialogConfirm.vue_vue_type_script_setup_true_lang-C_UyCIvg.js";import{d as M}from"./debounce-DqPPCsFD.js";const O={name:[F],description:[]},A=()=>({id:null,name:"",description:null,status:!0}),R=$({__name:"Form",props:{formState:{type:Object,default:()=>({})}},emits:["onSuccess"],setup(C,{emit:m}){const r=m,u=C,p=d(!1),n=d(!1),t=d(null),l=d({...A(),...u.formState}),g=async()=>{const{valid:v}=await t.value.validate();if(!v)return;p.value=!0,await j(l.value)&&(r("onSuccess"),n.value=!1),p.value=!1};return(v,s)=>{const V=a("v-text-field"),c=a("v-col"),_=a("v-textarea"),i=a("v-switch"),T=a("v-row"),D=a("v-card-item"),U=a("v-btn"),P=a("v-spacer"),S=a("v-card-actions"),E=a("v-card"),I=a("v-form"),N=a("v-dialog");return y(),x(N,{"max-width":"700",modelValue:n.value,"onUpdate:modelValue":s[4]||(s[4]=f=>n.value=f),activator:"parent"},{default:o(()=>[e(I,{ref_key:"formRef",ref:t,onSubmit:G(g,["prevent"])},{default:o(()=>[e(E,{title:l.value.id?"Editar Registro":"Nuevo Registro"},{default:o(()=>[e(D,{class:"border-t border-b"},{default:o(()=>[e(T,null,{default:o(()=>[e(c,{cols:"12"},{default:o(()=>[e(V,{modelValue:l.value.name,"onUpdate:modelValue":s[0]||(s[0]=f=>l.value.name=f),label:"Nombre",rules:w(O).name},null,8,["modelValue","rules"])]),_:1}),e(c,{cols:"12"},{default:o(()=>[e(_,{modelValue:l.value.description,"onUpdate:modelValue":s[1]||(s[1]=f=>l.value.description=f),label:"Descripción",rules:w(O).description,rows:"2"},null,8,["modelValue","rules"])]),_:1}),e(c,{cols:"12"},{default:o(()=>[e(i,{label:l.value.status?"Habilitado":"Deshabilitado",modelValue:l.value.status,"onUpdate:modelValue":s[2]||(s[2]=f=>l.value.status=f),color:"blue-darken-4",inset:""},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1}),e(S,null,{default:o(()=>[e(U,{type:"button",variant:"text",color:"secondary",onClick:s[3]||(s[3]=f=>n.value=!1)},{default:o(()=>s[5]||(s[5]=[b(" Cancelar ")])),_:1}),e(P),e(U,{text:"Guardar",color:"primary",type:"submit",loading:p.value},null,8,["loading"])]),_:1})]),_:1},8,["title"])]),_:1},512)]),_:1},8,["modelValue"])}}}),J=[{title:"Op.",key:"actions",value:"actions",fixed:!0,width:"50px",sortable:!1},{title:"Nombre",key:"name",value:"name"},{title:"Descripción",key:"description",value:"description"},{title:"Estado",key:"status",value:"status"}],K=$({__name:"DataTable",props:{options:{},items:{},loading:{type:Boolean},total:{}},emits:["onUpdateTable"],setup(C,{emit:m}){const r=m,u=d(!1),p=async n=>{u.value=!0,await q(n)&&r("onUpdateTable"),u.value=!1};return(n,t)=>{const l=a("v-icon"),g=a("v-list-item"),v=a("v-list"),s=a("v-menu"),V=a("v-btn"),c=a("v-data-table-server"),_=B("permission");return y(),x(c,{"items-per-page":n.options.itemsPerPage,"onUpdate:itemsPerPage":[t[1]||(t[1]=i=>n.options.itemsPerPage=i),t[4]||(t[4]=i=>r("onUpdateTable"))],"sort-by":n.options.sortBy,"onUpdate:sortBy":[t[2]||(t[2]=i=>n.options.sortBy=i),t[5]||(t[5]=i=>r("onUpdateTable"))],page:n.options.page,"onUpdate:page":[t[3]||(t[3]=i=>n.options.page=i),t[6]||(t[6]=i=>r("onUpdateTable"))],headers:w(J),items:n.items,"items-length":n.total,loading:u.value,"item-value":"id","multi-sort":""},{"item.actions":o(({item:i})=>[k((y(),x(V,{icon:"",density:"compact",variant:"text"},{default:o(()=>[e(l,null,{default:o(()=>t[7]||(t[7]=[b("mdi-dots-vertical")])),_:1}),e(s,{activator:"parent"},{default:o(()=>[e(v,{density:"compact"},{default:o(()=>[k((y(),x(g,{key:"edit",value:"edit","append-icon":"mdi-pencil",class:"text-subtitle-2"},{append:o(()=>[e(l,{size:"small"},{default:o(()=>t[8]||(t[8]=[b(" mdi-pencil ")])),_:1})]),default:o(()=>[t[9]||(t[9]=b(" Editar ")),e(w(R),{formState:i,onOnSuccess:t[0]||(t[0]=T=>r("onUpdateTable"))},null,8,["formState"])]),_:2},1024)),[[_,["positions.edit"]]]),k((y(),x(g,{key:"delete",value:"delete",class:"text-red text-subtitle-2"},{append:o(()=>[e(l,{size:"small",color:"red"},{default:o(()=>t[10]||(t[10]=[b(" mdi-delete ")])),_:1})]),default:o(()=>[t[11]||(t[11]=b(" Eliminar ")),e(L,{title:"Eliminar",message:"¿Está seguro de eliminar este registro?","text-cancel":"No","text-confirm":"Confirmar",loading:u.value,onOnConfirm:()=>p(i.id)},null,8,["loading","onOnConfirm"])]),_:2},1024)),[[_,["positions.delete"]]])]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[_,["positions.edit","positions.delete"]]])]),"item.status":o(({item:i})=>[e(V,{color:i.status?"blue":"error","text-color":"white",density:"compact",variant:"tonal"},{default:o(()=>[b(H(i.status?"Habilitado":"Deshabilitado"),1)]),_:2},1032,["color"])]),_:1},8,["items-per-page","sort-by","page","headers","items","items-length","loading"])}}}),h=$({__name:"index",setup(C){const m=d(!1),r=d(!1),u=d([]),p=d(0),n=d({itemsPerPage:10,sortBy:[],page:1,search:"",filters:{}}),t=M(()=>{l()},400),l=async()=>{r.value=!0;const v=await z(n.value);u.value=v.data,p.value=v.total,r.value=!1},g=async()=>{m.value=!0,await l(),m.value=!1};return g(),(v,s)=>{const V=a("v-text-field"),c=a("v-col"),_=a("v-btn"),i=a("v-row"),T=a("v-card-item"),D=a("v-card"),U=B("permission"),P=B("tooltip");return y(),x(D,{title:"Cargos",subtitle:"Gestion de Cargos de Trabajo",disabled:m.value},{default:o(()=>[e(T,{class:"border-t border-b"},{default:o(()=>[e(i,{class:"d-flex justify-space-between"},{default:o(()=>[e(c,{cols:"12",md:"4"},{default:o(()=>[e(V,{modelValue:n.value.search,"onUpdate:modelValue":s[0]||(s[0]=S=>n.value.search=S),label:"Buscar",clearable:"",onInput:w(t)},null,8,["modelValue","onInput"])]),_:1}),e(c,{cols:"12",md:"4",class:"d-md-flex d-block justify-end text-end"},{default:o(()=>[k((y(),x(_,{class:"h-md-auto me-2",disabled:m.value},{default:o(()=>[s[1]||(s[1]=b(" nuevo ")),e(w(R),{onOnSuccess:l})]),_:1},8,["disabled"])),[[U,["positions.create"]]]),k(e(_,{class:"h-md-auto",density:"comfortable",icon:"mdi-reload",onClick:g,loading:r.value},null,8,["loading"]),[[P,"Recargar registros"],[U,["positions.index"]]])]),_:1})]),_:1})]),_:1}),k(e(w(K),{options:n.value,loading:r.value,items:u.value,total:p.value,onOnUpdateTable:l},null,8,["options","loading","items","total"]),[[U,["positions.index"]]])]),_:1},8,["disabled"])}}});export{h as default};
